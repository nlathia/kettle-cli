# kettle

⚠️ This repo is currently being renamed (it used to be called `operator`) and it has not been fully tested with its new name yet.

Kettle is a command line tool for creating and deploying http-triggered functions that run in the cloud.

You can use it to generate and deploy AWS [Lambda](https://aws.amazon.com/lambda/)s, Google [Cloud Functions](https://cloud.google.com/functions) and Google [Cloud Run](https://cloud.google.com/run) containerised applications, in either Go or Python.

The Python functions have been specifically designed to support deploying machine learning models.

This CLI has three primary commands:

* `kettle init` is a one-off command that sets up the tool with your preferences (for cloud provider, programming language, etc.)
* `kettle create <name>` creates a directory containing all the boiler plate code that you need to get going. 
* `kettle deploy <path>` deploys the code in that directory to the cloud.

## Pre-requisites

Operator relies on you having a few things installed already.

### Cloud Providers

For AWS Lambdas:

* The [aws cli](https://aws.amazon.com/cli/).

For Google Cloud Functions:

* The [gcloud](https://cloud.google.com/sdk/gcloud) SDK
* Enable the Cloud Functions API in the GCP console

For Google Cloud Run:

* The [gcloud](https://cloud.google.com/sdk/gcloud) SDK
* Enable the Cloud Run API in the GCP console
* [Optional] [Docker](https://docs.docker.com/get-docker/) to build and run Cloud Run containerized applications locally.

### Programming Languages

For Python deployments:

* Both [pyenv](https://github.com/pyenv/pyenv) and [pyenv-virtualenv](https://github.com/pyenv/pyenv-virtualenv): the boiler plate generated by this tool enables you to create Python virtual environments, but assumes you have these tools installed already.

For Go deployments:

* Go version 1.13

## Installing with brew

You can install `operator` using `brew` and [the operatorai tap](https://github.com/operatorai/homebrew-tap).

```bash
❯ brew tap operatorai/tap
❯ brew install operator
```

## Usage

First, set up the CLI tool using `operator init`. It will take you through a one-off set up, and store your preferences.

```bash
❯ kettle init
[...]
Use the arrow keys to navigate: ↓ ↑ → ← 
? Deployment type: 
  ▸ Google Cloud Function
    Google Cloud Run
```

Create a new deployment with `operator create` (check out `operator create --help` for a full list of options).

```bash
❯ kettle create hello-world
```

This will create a directory called (in this example) `hello-world` and it will add all the boiler plate you need to get going. For details about the generated boiler plate, see below.

You can now change into the `hello-world` directory, and use the `make install` command to create a `pyenv` virtual environment for your deployment.

```bash
❯ cd hello-world
❯ make install # To create a pyenv-virtualenv
```

Launch it locally:

```bash
❯ make localhost
```

... and, when you're ready, deploy it!

```bash
❯ kettle deploy .
```

## Bug Reports

Please report any bugs or issues to me (neal.lathia@gmail.com) or by raising an issue in this repo.
